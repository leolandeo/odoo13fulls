<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="gestionit_pe_fe.view_account_move_tipo_comprobante" model="ir.ui.view">
            <field name="name">Tipo de comprobante</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='ref']" position="after">
                    <field name="invoice_type_code"/>
                    <field name="tipo_nota_credito" attrs="{'invisible': [('invoice_type_code','!=','07')],'required':[('invoice_type_code','=','07')]}"/>
                    <field name="tipo_nota_debito" attrs="{'invisible': [('invoice_type_code','!=','08')],'required':[('invoice_type_code','=','08')]}"/>
                    <field name="sustento_nota" attrs="{'invisible': [('invoice_type_code','!=','07'),('invoice_type_code','!=','08')],'required':[('invoice_type_code','!=','01'),('invoice_type_code','!=','03')]}"/>
                    <!-- <field name="estado_emision" readonly="1" force_save="1" groups="base.group_user"/> -->
                    <field name="estado_emision" readonly="1" force_save="1"/>
                </xpath>
                <xpath expr="//field[@name='journal_id']" position="replace">
                    <field name="tipo_operacion" string="Tipo de Operación" attrs="{'readonly':[['state','not in',['draft']]]}" widget="radio" />
                    <field name="journal_id" string="Serie" options="{'no_create': True,'no_open':True}" domain="[('invoice_type_code_id','=',invoice_type_code),('type','=','sale')]"/>
                </xpath>
            </field>
        </record>

        <record id="gestionit_pe_fe.view_account_move_almacenes_series_permitidas" model="ir.ui.view">
            <field name="name">Almacenes y series permitidas</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='journal_id']" position="before">
                    <field name="warehouses_allowed_ids" widget="many2many_tags" groups="base.group_no_one"/>
                    <field name="warehouse_id" domain="[('id','in',warehouses_allowed_ids)]" string="Almacén" options="{'no_create': True, 'no_create_edit':True, 'no_open': True}"/>
                    <field name="journal_ids" widget="many2many_tags" string="Series Permitidas" groups="base.group_no_one"/>
                </xpath>
                <xpath expr="//field[@name='journal_id']" position="attributes">
                    <attribute name="domain">[('invoice_type_code_id','=',invoice_type_code), ('type','=','sale'),('id','in',journal_ids)]</attribute>
                </xpath>
            </field>
        </record>

        <record model="ir.ui.view" id="gestionit_pe_fe.view_account_invoice_form_desglose_venta">
            <field name="name">Totales de venta</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='amount_untaxed']" position="replace">
                    <field name="descuento_global" string="Descuento Global (%)"/>
                    <field name="total_venta_gravado" string="Monto Gravado"/>
                    <field name="amount_igv"/>
                    <field name="total_venta_inafecto" string="Monto Inafecto"/>
                    <field name="total_venta_exonerada" string="Monto Exonerado"/>
                    <field name="total_venta_gratuito" string="Monto Gratuito"/>
                    <field name="total_descuento_global" attrs="{'invisible':[('invoice_type_code','not in',['01','03'])]}" string="Descuento Global"/>
                    <field name="total_descuentos" string="Total de Descuentos"/>
                </xpath>
                <xpath expr="//field[@name='amount_by_group']" position="replace">
                </xpath>
            </field>
        </record>

        <record model="ir.ui.view" id="gestionit_pe_fe.view_account_invoice_form_json_page">
            <field name="name">Json page</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                <xpath expr="//page[@name='other_info']" position="after">
                    <page string="Comprobante" groups="base.group_no_one">
                        <group>
                            <field name="json_comprobante" attrs="{'readonly':[['state','not in',['draft']]]}"/>
                            <field name="json_respuesta"/>
                            <field name="status_envio" attrs="{'readonly':[['state','not in',['draft']]]}"/>
                            <!-- <field name="status_baja" attrs="{'readonly':[['state','not in',['draft']]]}"/>
                            <field name="new_invoice" attrs="{'readonly':[['state','not in',['draft']]]}"/> -->
                        </group>
                        <group string = "Status">
                            <field name="account_log_status_ids" mode="tree" attrs="{'readonly':[['state','not in',['draft']]]}">
                                <tree>
                                    <field name="name"/>
                                    <field name="account_move_id"/>
                                    <field name="api_request_id"/>
                                    <field name="status"/>
                                </tree>
                            </field>
                        </group>
                    </page>
                    <!-- <page string="Validez de Comprobante" groups="base.group_no_one">
                        <group>
                            <field name="estado_emision" groups="account.group_account_manager"/>
                            <field name="estado_comprobante_electronico" groups="account.group_account_manager"/>
                            <field name="estado_contribuyente_ruc" groups="account.group_account_manager"/>
                            <field name="condicion_domicilio_contribuyente" groups="account.group_account_manager"/>
                        </group>
                    </page> -->
                </xpath>
            </field>
        </record>

        <record model="ir.ui.view" id="gestionit_pe_fe.view_account_invoice_form_buttons">
            <field name="name">Botones para documentos</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                <xpath expr="//button[@name='action_reverse']" position="after">
                    <!-- <button name="generar_nota_credito" string="Generar Nota de Crédito" class="oe_highlight" type="object" attrs="{'invisible': ['|','|',('invoice_type_code','not in',['00','01','03']),('state','in',('cancel','draft')),('documento_baja_id','!=',False)]}"/> -->
                    <button name="generar_nota_credito" string="Generar Nota de Crédito" class="oe_highlight" type="object" attrs="{'invisible': ['|','|',('invoice_type_code','not in',['00','01','03']),('state','in',('cancel','draft'))]}"/>
                    <button name="generar_nota_debito" string="Generar Nota de Débito" class="oe_highlight" type="object" attrs="{'invisible': ['|','|',('invoice_type_code','not in',['00','01','03']),('state','in',('cancel','draft'))]}"/>
                </xpath>
            </field>
        </record>

    </data>
</odoo>
